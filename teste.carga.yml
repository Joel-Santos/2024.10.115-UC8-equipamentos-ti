config:
  target: "http://localhost:3000"
  phases:
    - duration: 10
      arrivalRate: 2
scenarios:
  - flow:
      # Passo 1: Geração de email único com timestamp
      - vars:
          timestamp: "{{ new Date().getTime() }}"  # Gerando timestamp dinâmico
          email: "joao.silva.{{ timestamp }}@email.com"  # Usando o timestamp para email único

      - post:
          url: "/api/cadastrar"
          json:
            nome: "João Silva"
            email: "{{ email }}"  # Usando o email gerado
            senha: "MinhaSenh@123"
            papel: "colaborador"

      # # Passo 2: Log para verificar o timestamp e email gerados
      # - log: "Timestamp gerado: {{ timestamp }}, Email gerado: {{ email }}"  # Exibe o timestamp e o email para depuração

      # # Passo 3: Login e captura do token de acesso
      # - post:
      #     url: "/api/login"
      #     json:
      #       email: "{{ email }}"  # Usando o email gerado no login
      #       senha: "MinhaSenh@123"
      #     capture:
      #       - json: "$.tokenAcesso"
      #         as: "token"  # Captura o token de acesso e o armazena na variável 'token'

      # # Passo 4: Acessa o perfil com o token de autenticação
      # - get:
      #     url: "/api/perfil"
      #     headers:
      #       Authorization: "Bearer {{ token }}"  # Usa o token capturado nas etapas anteriores
